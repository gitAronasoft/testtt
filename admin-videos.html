<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Videos - YouTube Video Manager</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <!-- Global Navbar will be injected here -->

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="dashboard.html">
                            <i class="fas fa-tachometer-alt"></i> Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="user-management.html">
                            <i class="fas fa-users"></i> Users
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="admin-videos.html">
                            <i class="fas fa-video"></i> All Videos
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="analytics.html">
                            <i class="fas fa-chart-line"></i> Analytics
                        </a>
                    </li>
                </ul>

                <div class="navbar-nav">
                    <div class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown">
                            <div class="user-avatar me-2" id="navUserAvatar">A</div>
                            <span id="navUserName">Admin</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="profile.html"><i class="fas fa-user"></i> Profile</a></li>
                            <li><a class="dropdown-item" href="settings.html"><i class="fas fa-cog"></i> Settings</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Page Header -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h2><i class="fas fa-video text-primary"></i> All Videos</h2>
                <p class="text-muted">View and manage all platform videos</p>
            </div>
            <div>
                <button class="btn btn-outline-secondary" onclick="refreshVideos()">
                    <i class="fas fa-sync-alt"></i> Refresh
                </button>
                <a href="dashboard.html" class="btn btn-secondary">Back to Dashboard</a>
            </div>
        </div>

        <!-- Statistics Cards -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card border-0 shadow-sm">
                    <div class="card-body text-center">
                        <div class="display-6 text-primary mb-2">
                            <i class="fas fa-video"></i>
                        </div>
                        <h4 class="text-primary" id="totalVideosCount">0</h4>
                        <p class="text-muted mb-0">Total Videos</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-0 shadow-sm">
                    <div class="card-body text-center">
                        <div class="display-6 text-success mb-2">
                            <i class="fas fa-eye"></i>
                        </div>
                        <h4 class="text-success" id="totalViewsCount">0</h4>
                        <p class="text-muted mb-0">Total Views</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-0 shadow-sm">
                    <div class="card-body text-center">
                        <div class="display-6 text-warning mb-2">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <h4 class="text-warning" id="totalRevenueCount">$0</h4>
                        <p class="text-muted mb-0">Total Revenue</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-0 shadow-sm">
                    <div class="card-body text-center">
                        <div class="display-6 text-info mb-2">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h4 class="text-info" id="totalEditorsCount">0</h4>
                        <p class="text-muted mb-0">Content Creators</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filter and Search -->
        <div class="card mb-4">
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="searchVideos" placeholder="ðŸ” Search videos...">
                    </div>
                    <div class="col-md-2">
                        <select class="form-select" id="statusFilter">
                            <option value="">All Status</option>
                            <option value="published">Published</option>
                            <option value="private">Private</option>
                            <option value="unlisted">Unlisted</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <select class="form-select" id="uploaderFilter">
                            <option value="">All Creators</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <select class="form-select" id="sortFilter">
                            <option value="newest">Newest First</option>
                            <option value="oldest">Oldest First</option>
                            <option value="most_viewed">Most Viewed</option>
                            <option value="title">Title A-Z</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <button class="btn btn-outline-secondary w-100" onclick="clearFilters()">Clear Filters</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Videos Grid -->
        <div class="row" id="videosContainer">
            <!-- Videos will be loaded here -->
        </div>

        <!-- No Videos Message -->
        <div id="noVideos" class="text-center py-5" style="display: none;">
            <div class="text-muted">
                <i class="fas fa-video fa-4x mb-3"></i>
                <h4>No videos found</h4>
                <p>No videos match your current filters.</p>
            </div>
        </div>

        <!-- Pagination -->
        <nav aria-label="Videos pagination" class="mt-4">
            <ul class="pagination justify-content-center" id="pagination">
            </ul>
        </nav>
    </div>

    <!-- Video Details Modal -->
    <div class="modal fade" id="videoDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Video Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="videoDetailsContent">
                    <!-- Video details will be loaded here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/common.js"></script>
    <script src="assets/js/visual-enhancements.js"></script>
    <script>
        let allVideos = [];
        let filteredVideos = [];
        let currentPage = 1;
        const videosPerPage = 9;

        document.addEventListener('DOMContentLoaded', function() {
            // Check if user is admin
            const userRole = localStorage.getItem('userRole');
            if (userRole !== 'admin') {
                showAlert('Access denied. This page is for admins only.', 'error');
                setTimeout(() => {
                    window.location.href = 'dashboard.html';
                }, 2000);
                return;
            }

            loadVideos();
            setupEventListeners();
            updateNavUser();
        });

        function updateNavUser() {
            const userName = localStorage.getItem('userName') || 'Admin';
            document.getElementById('navUserName').textContent = userName;
            document.getElementById('navUserAvatar').textContent = userName.charAt(0).toUpperCase();
        }

        function setupEventListeners() {
            document.getElementById('searchVideos').addEventListener('input', applyFilters);
            document.getElementById('statusFilter').addEventListener('change', applyFilters);
            document.getElementById('uploaderFilter').addEventListener('change', applyFilters);
            document.getElementById('sortFilter').addEventListener('change', applyFilters);
        }

        function loadVideos() {
            // Get uploaded videos and system videos
            const uploadedVideos = JSON.parse(localStorage.getItem('uploadedVideos') || '[]');
            const systemVideos = [
                {
                    id: 'SYS_001',
                    title: 'Advanced Web Development Course',
                    description: 'Complete guide to modern web development',
                    price: 29.99,
                    thumbnail: 'ðŸ’»',
                    duration: '2:30:00',
                    uploadedBy: 'Expert Instructor',
                    uploadedAt: '2024-01-10T00:00:00Z',
                    status: 'published',
                    views: 15420,
                    likes: 892
                },
                {
                    id: 'SYS_002',
                    title: 'JavaScript Mastery',
                    description: 'Master JavaScript from basics to advanced',
                    price: 24.99,
                    thumbnail: 'âš¡',
                    duration: '1:45:00',
                    uploadedBy: 'Code Academy',
                    uploadedAt: '2024-01-15T00:00:00Z',
                    status: 'published',
                    views: 8750,
                    likes: 456
                },
                {
                    id: 'SYS_003',
                    title: 'React Development Bootcamp',
                    description: 'Build modern React applications',
                    price: 34.99,
                    thumbnail: 'âš›ï¸',
                    duration: '3:00:00',
                    uploadedBy: 'React Expert',
                    uploadedAt: '2024-01-20T00:00:00Z',
                    status: 'published',
                    views: 12300,
                    likes: 678
                }
            ];

            allVideos = [...uploadedVideos.map(v => ({...v, price: v.price || 19.99})), ...systemVideos];

            populateUploaderFilter();
            updateStatistics();
            applyFilters();
        }

        function populateUploaderFilter() {
            const uploaders = [...new Set(allVideos.map(v => v.uploadedBy))];
            const filter = document.getElementById('uploaderFilter');

            filter.innerHTML = '<option value="">All Creators</option>';
            uploaders.forEach(uploader => {
                filter.innerHTML += `<option value="${uploader}">${uploader}</option>`;
            });
        }

        function updateStatistics() {
            const totalVideos = allVideos.length;
            const totalViews = allVideos.reduce((sum, video) => sum + (video.views || 0), 0);
            const totalRevenue = allVideos.reduce((sum, video) => sum + ((video.price || 0) * (video.sales || 5)), 0);
            const totalCreators = new Set(allVideos.map(v => v.uploadedBy)).size;

            document.getElementById('totalVideosCount').textContent = totalVideos;
            document.getElementById('totalViewsCount').textContent = formatNumber(totalViews);
            document.getElementById('totalRevenueCount').textContent = '$' + formatNumber(totalRevenue);
            document.getElementById('totalEditorsCount').textContent = totalCreators;
        }

        function applyFilters() {
            const searchTerm = document.getElementById('searchVideos').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const uploaderFilter = document.getElementById('uploaderFilter').value;
            const sortFilter = document.getElementById('sortFilter').value;

            filteredVideos = allVideos.filter(video => {
                const matchesSearch = !searchTerm || 
                    video.title.toLowerCase().includes(searchTerm) ||
                    video.description.toLowerCase().includes(searchTerm);

                const matchesStatus = !statusFilter || video.status === statusFilter;
                const matchesUploader = !uploaderFilter || video.uploadedBy === uploaderFilter;

                return matchesSearch && matchesStatus && matchesUploader;
            });

            sortVideos(sortFilter);
            currentPage = 1;
            renderVideos();
            renderPagination();
        }

        function sortVideos(sortBy) {
            switch(sortBy) {
                case 'newest':
                    filteredVideos.sort((a, b) => new Date(b.uploadedAt) - new Date(a.uploadedAt));
                    break;
                case 'oldest':
                    filteredVideos.sort((a, b) => new Date(a.uploadedAt) - new Date(b.uploadedAt));
                    break;
                case 'most_viewed':
                    filteredVideos.sort((a, b) => (b.views || 0) - (a.views || 0));
                    break;
                case 'title':
                    filteredVideos.sort((a, b) => a.title.localeCompare(b.title));
                    break;
            }
        }

        function renderVideos() {
            const container = document.getElementById('videosContainer');
            const noVideos = document.getElementById('noVideos');

            if (filteredVideos.length === 0) {
                container.innerHTML = '';
                noVideos.style.display = 'block';
                return;
            }

            noVideos.style.display = 'none';

            const startIndex = (currentPage - 1) * videosPerPage;
            const endIndex = startIndex + videosPerPage;
            const pageVideos = filteredVideos.slice(startIndex, endIndex);

            container.innerHTML = pageVideos.map(video => `
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card video-card h-100">
                        <div class="video-thumbnail">
                            ${video.thumbnail || 'ðŸŽ¥'}
                            <div class="video-duration">${video.duration || '10:00'}</div>
                            <div class="price-badge">$${video.price || 19.99}</div>
                        </div>
                        <div class="card-body">
                            <h6 class="video-title">${video.title}</h6>
                            <p class="video-description">${truncateText(video.description || '', 80)}</p>
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <small class="text-muted">By ${video.uploadedBy}</small>
                                <span class="badge ${getStatusBadgeClass(video.status)}">${video.status}</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <small class="text-muted">
                                    <i class="fas fa-eye"></i> ${formatNumber(video.views || 0)} views
                                </small>
                                <small class="text-muted">
                                    <i class="fas fa-thumbs-up"></i> ${formatNumber(video.likes || 0)}
                                </small>
                            </div>
                            <small class="text-muted d-block mb-3">${formatDate(video.uploadedAt)}</small>
                            <div class="d-grid gap-2">
                                <button class="btn btn-primary btn-sm" onclick="viewVideoDetails('${video.id}')">
                                    <i class="fas fa-info-circle"></i> View Details
                                </button>
                                <button class="btn btn-success btn-sm" onclick="watchVideoAsAdmin('${video.id}')">
                                    <i class="fas fa-play"></i> Watch (Admin Access)
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function getStatusBadgeClass(status) {
            const classes = {
                'published': 'bg-success',
                'private': 'bg-warning',
                'unlisted': 'bg-info',
                'draft': 'bg-secondary'
            };
            return classes[status] || 'bg-secondary';
        }

        function truncateText(text, maxLength) {
            if (!text) return '';
            return text.length > maxLength ? text.substring(0, maxLength) + '...' : text;
        }

        function formatNumber(num) {
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return num.toString();
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString();
        }

        function viewVideoDetails(videoId) {
            const video = allVideos.find(v => v.id === videoId);
            if (!video) return;

            const modalContent = document.getElementById('videoDetailsContent');
            modalContent.innerHTML = `
                <div class="row">
                    <div class="col-md-4">
                        <div class="video-thumbnail mb-3" style="height: 150px;">
                            ${video.thumbnail || 'ðŸŽ¥'}
                        </div>
                    </div>
                    <div class="col-md-8">
                        <h5>${video.title}</h5>
                        <p class="text-muted">${video.description}</p>
                        <div class="row">
                            <div class="col-sm-6">
                                <strong>Creator:</strong> ${video.uploadedBy}<br>
                                <strong>Duration:</strong> ${video.duration || 'N/A'}<br>
                                <strong>Price:</strong> $${video.price || 'Free'}<br>
                                <strong>Status:</strong> <span class="badge ${getStatusBadgeClass(video.status)}">${video.status}</span>
                            </div>
                            <div class="col-sm-6">
                                <strong>Views:</strong> ${formatNumber(video.views || 0)}<br>
                                <strong>Likes:</strong> ${formatNumber(video.likes || 0)}<br>
                                <strong>Upload Date:</strong> ${formatDate(video.uploadedAt)}<br>
                                <strong>Video ID:</strong> ${video.id}
                            </div>
                        </div>
                    </div>
                </div>
            `;

            new bootstrap.Modal(document.getElementById('videoDetailsModal')).show();
        }

        function watchVideoAsAdmin(videoId) {
            showAlert('As an admin, you have unlimited access to all videos. Video playback would start here.', 'success');
        }

        function renderPagination() {
            const pagination = document.getElementById('pagination');
            const totalPages = Math.ceil(filteredVideos.length / videosPerPage);

            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }

            let html = '';

            // Previous button
            html += `<li class="page-item ${currentPage === 1 ? 'disabled' : ''}">
                <a class="page-link" href="#" onclick="changePage(${currentPage - 1})">Previous</a>
            </li>`;

            // Page numbers
            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 2 && i <= currentPage + 2)) {
                    html += `<li class="page-item ${i === currentPage ? 'active' : ''}">
                        <a class="page-link" href="#" onclick="changePage(${i})">${i}</a>
                    </li>`;
                } else if (i === currentPage - 3 || i === currentPage + 3) {
                    html += '<li class="page-item disabled"><span class="page-link">...</span></li>';
                }
            }

            // Next button
            html += `<li class="page-item ${currentPage === totalPages ? 'disabled' : ''}">
                <a class="page-link" href="#" onclick="changePage(${currentPage + 1})">Next</a>
            </li>`;

            pagination.innerHTML = html;
        }

        function changePage(page) {
            const totalPages = Math.ceil(filteredVideos.length / videosPerPage);
            if (page >= 1 && page <= totalPages) {
                currentPage = page;
                renderVideos();
                renderPagination();
            }
        }

        function clearFilters() {
            document.getElementById('searchVideos').value = '';
            document.getElementById('statusFilter').value = '';
            document.getElementById('uploaderFilter').value = '';
            document.getElementById('sortFilter').value = 'newest';
            applyFilters();
        }

        function refreshVideos() {
            showAlert('Refreshing videos...', 'info');
            setTimeout(() => {
                loadVideos();
                showAlert('Videos refreshed!', 'success');
            }, 1000);
        }

        function logout() {
            localStorage.clear();
            window.location.href = 'login.html';
        }

        function showAlert(message, type) {
            const alertClass = type === 'success' ? 'alert-success' : 
                              type === 'error' ? 'alert-danger' : 
                              type === 'warning' ? 'alert-warning' : 'alert-info';

            const alertDiv = document.createElement('div');
            alertDiv.className = `alert ${alertClass} alert-dismissible fade show position-fixed`;
            alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            document.body.appendChild(alertDiv);

            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.parentNode.removeChild(alertDiv);
                }
            }, 5000);
        }
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Videos - Video Manager</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <div class="container main-content">
        <div class="row">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2><i class="fas fa-video me-2"></i>All Videos</h2>
                    <a href="dashboard.html" class="btn btn-outline-primary">
                        <i class="fas fa-arrow-left me-1"></i>Back to Dashboard
                    </a>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Video Management</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Title</th>
                                        <th>Author</th>
                                        <th>Upload Date</th>
                                        <th>Views</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="videosTableBody">
                                    <!-- Videos will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/common.js"></script>
    <script src="assets/js/navbar.js"></script>
    <script src="assets/js/navbar.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            loadAllVideos();
        });

        function loadAllVideos() {
            // Demo data
            const videos = [
                { title: 'React Tutorial', author: 'Editor User', date: '2024-01-15', views: 1234, status: 'Published' },
                { title: 'JavaScript Basics', author: 'Editor User', date: '2024-01-10', views: 856, status: 'Published' },
                { title: 'CSS Grid Guide', author: 'Another Editor', date: '2024-01-05', views: 642, status: 'Draft' }
            ];

            const tbody = document.getElementById('videosTableBody');
            const videosHTML = videos.map(video => `
                <tr>
                    <td>${video.title}</td>
                    <td>${video.author}</td>
                    <td>${video.date}</td>
                    <td>${video.views}</td>
                    <td><span class="badge ${video.status === 'Published' ? 'bg-success' : 'bg-warning'}">${video.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary me-1" onclick="viewVideo('${video.title}')">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteVideo('${video.title}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');

            tbody.innerHTML = videosHTML;
        }

        function viewVideo(title) {
            showAlert(`Viewing ${title}`, 'info');
        }

        function deleteVideo(title) {
            if (confirm(`Are you sure you want to delete "${title}"?`)) {
                showAlert(`${title} deleted successfully`, 'success');
                loadAllVideos();
            }
        }
    </script>
</body>
</html>
